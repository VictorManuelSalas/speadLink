<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>SpeadLink | Dashboard</title>
    <link rel="stylesheet" href="../style.css" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  </head>
  <body>
    <header>
      <h1>üìä SpeadLink Dashboard</h1>
    </header>

    <main>
      <!-- CLIENTES -->
      <section>
        <h2>üë§ Clientes</h2>
        <button onclick="openModal('customer')">Crear Cliente</button>
        <button onclick="getCustomers()">Cargar Clientes</button>
        <div id="customersList" class="cards"></div>
      </section>

      <!-- FACTURAS -->
      <section>
        <h2>üßæ Facturas</h2>

        <div class="filters">
          <input
            type="text"
            id="clientIdInput"
            placeholder="Client ID (opcional)"
          />
          <button onclick="getInvoices()">Cargar Facturas</button>

          <button onclick="openModal('invoice')">Nueva Factura</button>
        </div>

        <table>
          <thead>
            <tr>
              <th>#</th>
              <th>Cliente</th>
              <th>Status</th>
              <th>Mes</th>
              <th>Fecha Limite</th>
              <th>Total</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="invoicesTable"></tbody>
          <tfoot id="invoiceCount"></tfoot>
        </table>
      </section>
    </main>
    <!-- MODAL BACKDROP -->
    <div id="modalBackdrop" class="modal-backdrop hidden"></div>

    <!-- MODAL CREAR CLIENTE -->
    <div id="modalCustomer" class="modal hidden">
      <h3>‚ûï Crear Cliente</h3>
      <div>
        <select class="options" id="c_status">
          <option value="Processed">Processed</option>
          <option value="Agendado">Agendado</option>
          <option value="Inactive">Inactive</option>
        </select>

        <input id="c_name" placeholder="Nombre" />
        <input id="c_email" placeholder="Correo" />
        <input id="c_phone" placeholder="Tel√©fono" />
        <select class="options" id="c_plan">
          <option value="Basico">Basico</option>
          <option value="Intermedio">Intermedio</option>
          <option value="Custom">Custom</option>
        </select>

        <input id="c_megas" type="number" placeholder="Megas" />
        <input id="c_date" type="date" />

        <span
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
          "
        >
          <h4>üß© Servicios</h4>
          <button
            onclick="addNewService('servicesContainer')"
            style="height: fit-content; padding: 10px 20px"
          >
            +
          </button>
        </span>

        <div id="servicesContainer"></div>
      </div>

      <div class="modal-actions">
        <button onclick="closeModal()">Cancelar</button>
        <button class="primary" onclick="submitCustomer()">Guardar</button>
      </div>
    </div>

    <div id="modalCustomerView" class="modal hidden">
      <div id="customerDetails" class="customer-detail">
        <h2>üë§ Detalle del Cliente</h2>

        <div class="row">
          <span class="label">Nombre:</span>
          <span class="value" id="client_view_name"></span>
        </div>

        <div class="row">
          <span class="label">Estado:</span>
          <span class="value" id="client_view_stage"></span>
        </div>

        <div class="row">
          <span class="label">Tel√©fono:</span>
          <span class="value" id="client_view_phone"></span>
        </div>

        <div class="row">
          <span class="label">Correo:</span>
          <span class="value" id="client_view_email"></span>
        </div>

        <div class="row">
          <span class="label">Plan:</span>
          <span class="value" id="client_view_plan"></span>
        </div>

        <div class="row">
          <span class="label">Fecha de instalaci√≥n:</span>
          <span class="value" id="client_view_date"></span>
        </div>

        <div class="row">
          <span class="label">Fecha de creaci√≥n:</span>
          <span class="value" id="client_view_registred_date"></span>
        </div>

        <div class="row">
          <span class="label">Servicios Adicionales:</span>
        </div>
        <table>
          <thead>
            <tr>
              <th>Servicio</th>
              <th>Precio</th>
            </tr>
          </thead>
          <tbody id="client_view_services">
            <!-- Services will be populated here -->
          </tbody>
        </table>
      </div>

      <div class="modal-actions">
        <button onclick="closeModal()">Close</button>
      </div>
    </div>
    <div id="modalCustomerEdit" class="modal hidden">
      <h3>‚úèÔ∏èEditar Cliente</h3>
      <div>
        <select class="options" id="c_e_status">
          <option value="Processed">Processed</option>
          <option value="Agendado">Agendado</option>
          <option value="Inactive">Inactive</option>
        </select>

        <input id="c_e_name" placeholder="Nombre" /> <input id="c_e_id" hidden/>
        <input id="c_e_email" placeholder="Correo" />
        <input id="c_e_phone" placeholder="Tel√©fono" />
        <select class="options" id="c_e_plan">
          <option value="Basico">Basico</option>
          <option value="Intermedio">Intermedio</option>
          <option value="Custom">Custom</option>
        </select>

        <input id="c_e_megas" type="number" placeholder="Megas" />
        <input id="c_e_date" type="date" />

        <span
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
          "
        >
          <h4>üß© Servicios</h4>
          <button
            onclick="addNewService('servicesContainerEdit')"
            style="height: fit-content; padding: 10px 20px"
          >
            +
          </button>
        </span>

        <div id="servicesContainerEdit"></div>
      </div>

      <div class="modal-actions">
        <button onclick="closeModal()">Cancelar</button>
        <button class="primary" onclick="saveCustomer()">Guardar</button>
      </div>
    </div>
    <!-- MODAL CREAR FACTURA -->
    <div id="modalInvoice" class="modal hidden">
      <h3>üßæ Crear Factura</h3>

      <div>
        <div id="invoiceForm"></div>
        <input id="i_dia_instalacion" type="date" />

        <select class="options" id="i_plan">
          <option value="Basico">Basico</option>
          <option value="Intermedio">Intermedio</option>
          <option value="Custom">Custom</option>
        </select>
        <input id="i_megas" placeholder="Megas (ej: 10mbts)" />
        <input id="i_precio" type="number" placeholder="Precio" />

        <label class="checkbox">
          <label for="i_pagado">Pagado</label>
          <input
            style="width: fit-content"
            id="i_pagado"
            type="checkbox"
            placeholder="Pagado"
          />
        </label>
      </div>

      <div class="modal-actions">
        <button onclick="closeModal()">Cancelar</button>
        <button class="primary" onclick="submitInvoice()">Crear</button>
      </div>
    </div>

    <script src="./script.js"></script>
  </body>
</html>
